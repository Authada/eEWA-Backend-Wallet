# Wallet Backend

Generates cnonce for app attestations and device key PoP.

Returns wallet attestation based on https://datatracker.ietf.org/doc/html/draft-ietf-oauth-attestation-based-client-auth-02

- Checks iOS and Android app attestations.
- Checks Secure Element authentication key PoP if available.
- Checks device key proof.
- Device key proof contains app attestation and SE attestation in the payload.

## Signature and Key Algorithms
Please use EC 256 bit keys and ES256 as signature algorithm for proofs.

## App Attestation

Add attribute app_attestation in the proof. Content is a JSON object with fields `type` and `attestation`.

For type, these are supported:
- iOS
- Android

Type iOS expects a Base64 encoded iOS app attestation in the attestation attribute.
Type Android expects a comma-separated Base64 encoded list of the android key attestation certificate chain.

## Secure Element Attestation
Additionally, it is possible to send the attribute se_attestion in the proof. This must contain a Base64 encoded signature of the device public key used for the proof, signed with the authentication private key of the applet.

## Endpoints

### cnonce

Request:
```bash
curl https://id.staging.authada.de/eudi/wallet/cnonce -H "Accept: application/json" | jq .
```

Response:
```json
{"c_nonce":"ec795743-801b-463c-a47b-2d9857ce5b05","c_nonce_expires_in":300}
```

### attestation

Request:
```bash
curl https://id.staging.authada.de/eudi/wallet/attestation -H "Accept: application/json" -H "Content-Type: application/json" -d '{
    "proof": {
        "proof_type": "jwt",
        "jwt": "eyJ0eXAiOiJ3YWxsZXQtcHJvb2Yrand0IiwiYWxnIjoiRVMyNTYiLCJqd2siOnsia3R5IjoiRUMiLCJ1c2UiOiJzaWciLCJjcnYiOiJQLTI1NiIsImtpZCI6ImtMTDh1VnczNHZmemNpbWZkaUQ1WXpTblkvRFR5M0hqdnJ1cklsdURvdnM9IiwieCI6IlM5VVN4ZDlMR29NVHJEbWphczVyYlNPSUtoR0E1V0JhLWpEUUZSNFNoUkUiLCJ5IjoiTFBKM0NSLVVmcWRDUVZGSjdKbmxuTUh4bnY2ZXA3WjN3M3JieFBLNDBDQSIsImlhdCI6MTcxODM1NTYwMn19.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJhcHBfYXR0ZXN0YXRpb24iOnsidHlwZSI6ImlPUyIsImF0dGVzdGF0aW9uIjoibzJObWJYUnZZWEJ3YkdVdFlYQndZWFIwWlhOMFoyRjBkRk4wYlhTaVkzZzFZNEpaQXl3d2dnTW9NSUlDcnFBREFnRUNBZ1lCa0JIZTZLTXdDZ1lJS29aSXpqMEVBd0l3VHpFak1DRUdBMVVFQXd3YVFYQndiR1VnUVhCd0lFRjBkR1Z6ZEdGMGFXOXVJRU5CSURFeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhFekFSQmdOVkJBZ01Da05oYkdsbWIzSnVhV0V3SGhjTk1qUXdOakV5TVRNMU1qRTVXaGNOTWpVd05qRXlNREV3TXpFNVdqQ0JrVEZKTUVjR0ExVUVBd3hBT1RCaU1tWmpZamsxWXpNM1pUSm1OMll6TnpJeU9UbG1Oell5TUdZNU5qTXpOR0UzTmpObU1HUXpZMkkzTVdVelltVmlZbUZpTWpJMVlqZ3pZVEptWWpFYU1CZ0dBMVVFQ3d3UlFVRkJJRU5sY25ScFptbGpZWFJwYjI0eEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhFekFSQmdOVkJBZ01Da05oYkdsbWIzSnVhV0V3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVJvVHdkUnE5OXpJb2Vyc3hkbkt3VWY4dkJVTlFoelVJZjV3cC83YUFOL3VQL3ZKK0hETE1QZUR6dDQvUlVyWjBsWlkrU0kxdDIvY25xb0hoYUw0YUpsbzRJQk1UQ0NBUzB3REFZRFZSMFRBUUgvQkFJd0FEQU9CZ05WSFE4QkFmOEVCQU1DQlBBd2Z3WUpLb1pJaHZkalpBZ0ZCSEl3Y0tRREFnRUt2NGt3QXdJQkFiK0pNUU1DQVFDL2lUSURBZ0VCdjRrekF3SUJBYitKTkNBRUhsSkRPRVk0VUVGS00wb3VaR1V1WVhWMGFHRmtZUzVsWlhkaExtUmxkcVVHQkFSemEzTWd2NGsyQXdJQkJiK0pOd01DQVFDL2lUa0RBZ0VBdjRrNkF3SUJBTCtKT3dNQ0FRQXdWd1lKS29aSWh2ZGpaQWdIQkVvd1NMK0tlQWdFQmpFM0xqVXVNYitJVUFjQ0JRRC8vLy8vdjRwN0J3UUZNakZHT1RDL2luMElCQVl4Tnk0MUxqRy9pbjREQWdFQXY0c01Ed1FOTWpFdU5pNDVNQzR3TGpBc01EQXpCZ2txaGtpRzkyTmtDQUlFSmpBa29TSUVJRTNKMEVkbTA1RE5rS0Qvd1oxcW96MEhuUlFJQ0ZOamVnbTlySnI0VFNuUU1Bb0dDQ3FHU000OUJBTUNBMmdBTUdVQ01GRTNwRTZJUmUvVHN4ZlZWZWx4Q0lObGd2YXJjYnVCeGxXLzc1MFUvbnB3VmNpeFU2S3pZdnpXMVEzMkZURjg1UUl4QUlaaHBaQUxMbUY3ZU1kelphRnNiU0I4Uzh5dXNtcHRzUDNjMDhPdTJhU2U0MSt6TkV5UDlHTUQvam01YTZtdlNGa0NSekNDQWtNd2dnSElvQU1DQVFJQ0VBbTZ4ZUc4UUJyWjFGT1Z2RGdhQ0ZRd0NnWUlLb1pJemowRUF3TXdVakVtTUNRR0ExVUVBd3dkUVhCd2JHVWdRWEJ3SUVGMGRHVnpkR0YwYVc5dUlGSnZiM1FnUTBFeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhFekFSQmdOVkJBZ01Da05oYkdsbWIzSnVhV0V3SGhjTk1qQXdNekU0TVRnek9UVTFXaGNOTXpBd016RXpNREF3TURBd1dqQlBNU013SVFZRFZRUUREQnBCY0hCc1pTQkJjSEFnUVhSMFpYTjBZWFJwYjI0Z1EwRWdNVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFVE1CRUdBMVVFQ0F3S1EyRnNhV1p2Y201cFlUQjJNQkFHQnlxR1NNNDlBZ0VHQlN1QkJBQWlBMklBQks1Yk42QjNUWG15Tlk5QTU5SHlKaWJ4d2wvdkY0QXQ2ck9DYWxtSFQvalNyUlVsZUpxaVpnUVpFa2kyUExsbkJwNlkwMk85WGpjUHY2Q09NcDZBYzZtRjUzUnVvMW1pOW04cDJ6S3ZSVjRoRmxqVlo2K2VKbjZ5WVUzQ0dtYk9tYU5tTUdRd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFEQWZCZ05WSFNNRUdEQVdnQlNza1JCVE03MithRUgvcHd5cDVmcnE1ZVdLb1RBZEJnTlZIUTRFRmdRVVB1TmRIQVFacWNtME1maUVkTmJoNFZkeTQ1c3dEZ1lEVlIwUEFRSC9CQVFEQWdFR01Bb0dDQ3FHU000OUJBTURBMmtBTUdZQ01RQzd2b2lOYzQwRkFzKzgvV1p0Q1ZkUU5ieldoeXcvaERCSkppbnQwZmtVNkhtWkhKcm90YTc0MDZoVU0vZTJEUVlDTVFDck9PM1F6SUh0QUtSU3c3cEUrWk5qWlZQK3pDbC9MclRmbjE2K1drckt0cGxjUzRJTitRUTRiM2dIdTFpVU9iZG5jbVZqWldsd2RGa09takNBQmdrcWhraUc5dzBCQndLZ2dEQ0FBZ0VCTVE4d0RRWUpZSVpJQVdVREJBSUJCUUF3Z0FZSktvWklodmNOQVFjQm9JQWtnQVNDQStneGdnUlRNQ1lDQVFJQ0FRRUVIbEpET0VZNFVFRktNMG91WkdVdVlYVjBhR0ZrWVM1bFpYZGhMbVJsZGpDQ0F6WUNBUU1DQVFFRWdnTXNNSUlES0RDQ0FxNmdBd0lCQWdJR0FaQVIzdWlqTUFvR0NDcUdTTTQ5QkFNQ01FOHhJekFoQmdOVkJBTU1Ha0Z3Y0d4bElFRndjQ0JCZEhSbGMzUmhkR2x2YmlCRFFTQXhNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVJNd0VRWURWUVFJREFwRFlXeHBabTl5Ym1saE1CNFhEVEkwTURZeE1qRXpOVEl4T1ZvWERUSTFNRFl4TWpBeE1ETXhPVm93Z1pFeFNUQkhCZ05WQkFNTVFEa3dZakptWTJJNU5XTXpOMlV5WmpkbU16Y3lNams1WmpjMk1qQm1PVFl6TXpSaE56WXpaakJrTTJOaU56RmxNMkpsWW1KaFlqSXlOV0k0TTJFeVptSXhHakFZQmdOVkJBc01FVUZCUVNCRFpYSjBhV1pwWTJGMGFXOXVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVJNd0VRWURWUVFJREFwRFlXeHBabTl5Ym1saE1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRWFFOEhVYXZmY3lLSHE3TVhaeXNGSC9Md1ZEVUljMUNIK2NLZisyZ0RmN2ovN3lmaHd5ekQzZzg3ZVAwVksyZEpXV1BraU5iZHYzSjZxQjRXaStHaVphT0NBVEV3Z2dFdE1Bd0dBMVVkRXdFQi93UUNNQUF3RGdZRFZSMFBBUUgvQkFRREFnVHdNSDhHQ1NxR1NJYjNZMlFJQlFSeU1IQ2tBd0lCQ3IrSk1BTUNBUUcvaVRFREFnRUF2NGt5QXdJQkFiK0pNd01DQVFHL2lUUWdCQjVTUXpoR09GQkJTak5LTG1SbExtRjFkR2hoWkdFdVpXVjNZUzVrWlhhbEJnUUVjMnR6SUwrSk5nTUNBUVcvaVRjREFnRUF2NGs1QXdJQkFMK0pPZ01DQVFDL2lUc0RBZ0VBTUZjR0NTcUdTSWIzWTJRSUJ3UktNRWkvaW5nSUJBWXhOeTQxTGpHL2lGQUhBZ1VBLy8vLy83K0tld2NFQlRJeFJqa3d2NHA5Q0FRR01UY3VOUzR4djRwK0F3SUJBTCtMREE4RURUSXhMall1T1RBdU1DNHdMREF3TXdZSktvWklodmRqWkFnQ0JDWXdKS0VpQkNCTnlkQkhadE9RelpDZy84R2RhcU05QjUwVUNBaFRZM29KdmF5YStFMHAwREFLQmdncWhrak9QUVFEQWdOb0FEQmxBakJSTjZST2lFWHYwN01YMVZYcGNRaURaWUwycTNHN2djWlZ2KytkRlA1NmNGWElzVk9pczJMODF0VU45aFV4Zk9VQ01RQ0dZYVdRQ3k1aGUzakhjMldoYkcwZ2ZFdk1yckpxYmJEOTNOUERydG1rbnVOZnN6Uk1qL1JqQS80NXVXdXByMGd3S0FJQkJBSUJBUVFnVXk2cXZaVjBpQTIvZHJtNHpBQ0RMQ0NtN0JFOWFDS1pWUTE2Ymc4MFhpVXdZQUlCQlFJQkFRUllUVzlJV25WcmJtNXNWM1paYUhGbGNqZFpiRlZTZFZCblVUaDVSVWxaUmxSUFlUY3pNbmxYUm1ab2VsTktZblZHY1hOTlJWRkRMMGxpT0UwMU55dEtMMVJXWkdKNFJFY3lXRlJQUTNJdkJHOVNhRlI1U2xCYVVUMDlNQTRDQVFZQ0FRRUVCa0ZVVkVWVFZEQVBBZ0VIQWdFQkJBZHpZVzVrWW05NE1DQUNBUXdDQVFFRUdESXdNalF0TURZdE1UTlVNVE02TlRJNk1Ua3VOalUzV2pBZ0FnRVZBZ0VCQkJneU1ESTBMVEE1TFRFeFZERXpPalV5T2pFNUxqWTFOMW9BQUFBQUFBQ2dnRENDQTY0d2dnTlVvQU1DQVFJQ0VINENFbURZem5lcmNxV2Q4R2dudnYwd0NnWUlLb1pJemowRUF3SXdmREV3TUM0R0ExVUVBd3duUVhCd2JHVWdRWEJ3YkdsallYUnBiMjRnU1c1MFpXZHlZWFJwYjI0Z1EwRWdOU0F0SUVjeE1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTXdIaGNOTWpRd01qSTNNVGd6T1RVeVdoY05NalV3TXpJNE1UZ3pPVFV4V2pCYU1UWXdOQVlEVlFRRERDMUJjSEJzYVdOaGRHbHZiaUJCZEhSbGMzUmhkR2x2YmlCR2NtRjFaQ0JTWldObGFYQjBJRk5wWjI1cGJtY3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRVZEZTRnc1pQeFJQcGVsSG5FblJWNFVzYWtBdVppOWZVRm9kcFB3dllrOHFMTmVvOVdDUEphbld0L0V5M2Y1TE1LWm1RazluRzNDMFlBTWtESVBSN1JLT0NBZGd3Z2dIVU1Bd0dBMVVkRXdFQi93UUNNQUF3SHdZRFZSMGpCQmd3Rm9BVTJSZitTMmVRT0V1UzlOdk8xVmVBRkF1UFBja3dRd1lJS3dZQkJRVUhBUUVFTnpBMU1ETUdDQ3NHQVFVRkJ6QUJoaWRvZEhSd09pOHZiMk56Y0M1aGNIQnNaUzVqYjIwdmIyTnpjREF6TFdGaGFXTmhOV2N4TURFd2dnRWNCZ05WSFNBRWdnRVRNSUlCRHpDQ0FRc0dDU3FHU0liM1kyUUZBVENCL1RDQnd3WUlLd1lCQlFVSEFnSXdnYllNZ2JOU1pXeHBZVzVqWlNCdmJpQjBhR2x6SUdObGNuUnBabWxqWVhSbElHSjVJR0Z1ZVNCd1lYSjBlU0JoYzNOMWJXVnpJR0ZqWTJWd2RHRnVZMlVnYjJZZ2RHaGxJSFJvWlc0Z1lYQndiR2xqWVdKc1pTQnpkR0Z1WkdGeVpDQjBaWEp0Y3lCaGJtUWdZMjl1WkdsMGFXOXVjeUJ2WmlCMWMyVXNJR05sY25ScFptbGpZWFJsSUhCdmJHbGplU0JoYm1RZ1kyVnlkR2xtYVdOaGRHbHZiaUJ3Y21GamRHbGpaU0J6ZEdGMFpXMWxiblJ6TGpBMUJnZ3JCZ0VGQlFjQ0FSWXBhSFIwY0RvdkwzZDNkeTVoY0hCc1pTNWpiMjB2WTJWeWRHbG1hV05oZEdWaGRYUm9iM0pwZEhrd0hRWURWUjBPQkJZRUZDdlBTUjc3enh0NUR2Q3ZBaWtUdFFFVzRYazBNQTRHQTFVZER3RUIvd1FFQXdJSGdEQVBCZ2txaGtpRzkyTmtEQThFQWdVQU1Bb0dDQ3FHU000OUJBTUNBMGdBTUVVQ0lRQ0hxQWtyZEYrWVFNVTZsQ0ZCR2wyTHFnbUExSWFTMWRiU21ablFlTWZLdFFJZ1AyVlRqQk1zejRnd05MQkhkZWlYVTgvUDAvZEVnMVc2bDFaY2ZZb0dnUnd3Z2dMNU1JSUNmNkFEQWdFQ0FoQlcrNFBVSy8rTnd6ZVpJN1Zhcm02OU1Bb0dDQ3FHU000OUJBTURNR2N4R3pBWkJnTlZCQU1NRWtGd2NHeGxJRkp2YjNRZ1EwRWdMU0JITXpFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEU1TURNeU1qRTNOVE16TTFvWERUTTBNRE15TWpBd01EQXdNRm93ZkRFd01DNEdBMVVFQXd3blFYQndiR1VnUVhCd2JHbGpZWFJwYjI0Z1NXNTBaV2R5WVhScGIyNGdRMEVnTlNBdElFY3hNU1l3SkFZRFZRUUxEQjFCY0hCc1pTQkRaWEowYVdacFkyRjBhVzl1SUVGMWRHaHZjbWwwZVRFVE1CRUdBMVVFQ2d3S1FYQndiR1VnU1c1akxqRUxNQWtHQTFVRUJoTUNWVk13V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVNTem1POWZZYXhxeWdLT3h6aHIvc0VsSUNSclBZeDM2YkxLRFZ2UkV2aEllVlgzUktOamJxQ2ZKVytTZnErTThxdXpRUVo4UzlESmZyMHZyUExnMzY2bzRIM01JSDBNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdId1lEVlIwakJCZ3dGb0FVdTdEZW9WZ3ppSnFraXBuZXZyM3JyOXJMSktzd1JnWUlLd1lCQlFVSEFRRUVPakE0TURZR0NDc0dBUVVGQnpBQmhpcG9kSFJ3T2k4dmIyTnpjQzVoY0hCc1pTNWpiMjB2YjJOemNEQXpMV0Z3Y0d4bGNtOXZkR05oWnpNd053WURWUjBmQkRBd0xqQXNvQ3FnS0lZbWFIUjBjRG92TDJOeWJDNWhjSEJzWlM1amIyMHZZWEJ3YkdWeWIyOTBZMkZuTXk1amNtd3dIUVlEVlIwT0JCWUVGTmtYL2t0bmtEaExrdlRienRWWGdCUUxqejNKTUE0R0ExVWREd0VCL3dRRUF3SUJCakFRQmdvcWhraUc5Mk5rQmdJREJBSUZBREFLQmdncWhrak9QUVFEQXdOb0FEQmxBakVBalcrbW42SGc1T3hiVG5PS2tuODllRk9Zai9UYUgxZ2V3M1ZLL2ppb1RDcURHaHFxRGFaa2JlRzVrK2pSVlV6dEFqQm5PeXkwNGVnM0IzZkwxZXgycUJvNlZUcy9OV3JJeGVhU3NPRmh2b0JKYWVSZks2bHM0UkVDcXN4aDJUaTNjMG93Z2dKRE1JSUJ5YUFEQWdFQ0FnZ3R4ZnlJMHNWTGxUQUtCZ2dxaGtqT1BRUURBekJuTVJzd0dRWURWUVFEREJKQmNIQnNaU0JTYjI5MElFTkJJQzBnUnpNeEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV6QWVGdzB4TkRBME16QXhPREU1TURaYUZ3MHpPVEEwTXpBeE9ERTVNRFphTUdjeEd6QVpCZ05WQkFNTUVrRndjR3hsSUZKdmIzUWdRMEVnTFNCSE16RW1NQ1FHQTFVRUN3d2RRWEJ3YkdVZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNSFl3RUFZSEtvWkl6ajBDQVFZRks0RUVBQ0lEWWdBRW1Pa3ZQVUJ5cE8yVEluS0JFeHpkRUpYeHhhTk9jZHdVRnRrTzVhWUZLbmRrZTE5T09OTzdIRVMxZi9VZnRqSmlYY25waEZ0UE1FOFJXZ0Q5V0ZnTXBmVVBMRTBIUnhOMTJwZVhsMjh4WE8wcm5Yc2dPOWk1Vk5sZW1hUTZVUW94bzBJd1FEQWRCZ05WSFE0RUZnUVV1N0Rlb1ZnemlKcWtpcG5ldnIzcnI5ckxKS3N3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFPQmdOVkhROEJBZjhFQkFNQ0FRWXdDZ1lJS29aSXpqMEVBd01EYUFBd1pRSXhBSVBwd2NRV1hocGROQmpaN2UvMGJBNEFSa3U0MzdKR0VjVVAvZVo2aktHbWE4N0NBOVNjOVpQR2RMaHEzNm9qRlFJd2JXYUtFTXJVRGRSUHpZMURQclNLWTZVemJ1TnQyaGUzWkIvSVV5YjVpR0owT1FzWFc4dFJxQXpvR0FQbm9ySW9BQUF4Z2Y0d2dmc0NBUUV3Z1pBd2ZERXdNQzRHQTFVRUF3d25RWEJ3YkdVZ1FYQndiR2xqWVhScGIyNGdTVzUwWldkeVlYUnBiMjRnUTBFZ05TQXRJRWN4TVNZd0pBWURWUVFMREIxQmNIQnNaU0JEWlhKMGFXWnBZMkYwYVc5dUlFRjFkR2h2Y21sMGVURVRNQkVHQTFVRUNnd0tRWEJ3YkdVZ1NXNWpMakVMTUFrR0ExVUVCaE1DVlZNQ0VINENFbURZem5lcmNxV2Q4R2dudnYwd0RRWUpZSVpJQVdVREJBSUJCUUF3Q2dZSUtvWkl6ajBFQXdJRVNEQkdBaUVBdThNc0JHRThueG4yamN4dVVhU3dEZFJOeXJVSndhRFd1MjdiSmJSWERwb0NJUURmQnRRVUYzWlE3UzI0bFltU0M1THRFdWt0ZjdWY05LRWh1dDJKMEZSWnZBQUFBQUFBQUdoaGRYUm9SR0YwWVZpa2hrYzlqN1ViUTBmTXBpeERaeG9oOXgxd0NjQ3J6cGYxRzU0SUp1YXhEVTFBQUFBQUFHRndjR0YwZEdWemRHUmxkbVZzYjNBQUlKQ3kvTGxjTitMMzgzSXBuM1lnK1dNMHAyUHcwOHR4NDc2N3F5SmJnNkw3cFFFQ0F5WWdBU0ZZSUdoUEIxR3IzM01paDZ1ekYyY3JCUi95OEZRMUNITlFoL25Dbi90b0EzKzRJbGdnLys4bjRjTXN3OTRQTzNqOUZTdG5TVmxqNUlqVzNiOXllcWdlRm92aG9tVT0ifSwibm9uY2UiOiJUZXN0IiwiaWF0IjoxNzE4MzU1NjAzfQ.24O92RjeQ_fgrk1obHJCOSAj8bus-8TSgQZaAB2A-zzvZGXj7o9zUqsP84QhvAea7K4ITLMZPyHWU8yl-_FUXA"
    }
}' | jq .
```

Decoded JWT header:
```json
{"typ":"wallet-proof+jwt","alg":"ES256","jwk":{"kty":"EC","use":"sig","crv":"P-256","kid":"3f14c9b8-2ab5-4d5d-b29a-b097a0816dce","x":"GkWEcXagtsxuUpvgTXFKphc16fTkPZ1XHfQHRNz29cI","y":"7_KIGqUek0xIhffw_L_DSw5v4WVx0IpZOH8rB1ZFnLE","iat":1718197462}
```

Decoded JWT payload:
```json
{"iss":"http://localhost:8080","aud":"http://localhost:8080","app_attestation":{"type":"iOS","attestation":"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"},"nonce":"Test","iat":1718355603}
```

Response:
```json
{"attestation":"eyJ0eXAiOiJ3YWxsZXQtYXR0ZXN0YXRpb24rand0IiwiYWxnIjoiRVMyNTYiLCJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTI1NiIsImtpZCI6IndhbGxldC1iYWNrZW5kLWtpZC0wIiwieDVjIjpbIk1JSUJHekNCd3FBREFnRUNBZ2hMUTdwOWo1WHZKekFLQmdncWhrak9QUVFEQWpBVU1SSXdFQVlEVlFRREV3bHNiMk5oYkdodmMzUXdIaGNOTWpRd05qRXlNVEkxT0RFeVdoY05NalV3TmpFeU1USTFPREV5V2pBVU1SSXdFQVlEVlFRREV3bHNiMk5oYkdodmMzUXdXVEFUQmdjcWhrak9QUUlCQmdncWhrak9QUU1CQndOQ0FBUjN5N3RPT282Vlh1RUwyQTIvN1o5Tm5iMEJuRVJQeDZBem81REMzdW50cDRCWlpNcnFIV2ZiWmZFUXhRREhvY0dDMmNwSEliUmhBZFpCQ3UyUUF4bXpNQW9HQ0NxR1NNNDlCQU1DQTBnQU1FVUNJQUVzd0VQcmJLQ241TUxWOTNYUVRqdXdHZGc4ekIzNGhRaEkvMGFGQXMxSEFpRUE0UnJUa3FwTlVJcmJGcnNhSE54eGZ0ZFV1blNIUTlPYVU2aFdvNG8rTFprPSJdLCJ4IjoiZDh1N1RqcU9sVjdoQzlnTnYtMmZUWjI5QVp4RVQ4ZWdNNk9Rd3Q3cDdhYyIsInkiOiJnRmxreXVvZFo5dGw4UkRGQU1laHdZTFp5a2NodEdFQjFrRUs3WkFER2JNIn19.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJzdWIiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJjbmYiOnsiandrIjp7Imt0eSI6IkVDIiwidXNlIjoic2lnIiwiY3J2IjoiUC0yNTYiLCJraWQiOiIyYTFkOWIwOC0xNGM3LTRkYTAtYmI4OS00YWQ2N2E2YWQwNGQiLCJ4IjoiYkRDM2MxQk5ISVhiTDdKeGZ0bkRRNVg4TXNLM0c3U3RHZnNCZmNMWVk5ZyIsInkiOiI1SlE1RjNzSkJ3VnJoM05KTVQyRnRqQWMyRDM1dmlHb2VlYkduOUVwOGJBIiwiaWF0IjoxNzE4MTk3NTM5fSwia2V5X3R5cGUiOiJzZWN1cmVfZWxlbWVudCIsInVzZXJfYXV0aGVudGljYXRpb24iOiJzZWN1cmVfZWxlbWVudF9waW4ifSwiZXhwIjoxNzE4MTk3ODk1LCJpYXQiOjE3MTgxOTc1OTUsImFhbCI6Imh0dHBzOi8vdHJ1c3QtbGlzdC5ldS9hYWwvaGlnaCJ9.bgYs5SrAUT3pU6xSmPym3fTMMx9kfHy9B9m1gHXoJI2w4GtghIbdxoxYhNUcEQNkaFw9xQC1gNPhDCBtkDpjlw"}
```

Decoded attestation header:

```json
{"typ":"wallet-attestation+jwt","alg":"ES256","jwk":{"kty":"EC","crv":"P-256","kid":"wallet-backend-kid-0","x5c":["MIIBGzCBwqADAgECAghLQ7p9j5XvJzAKBggqhkjOPQQDAjAUMRIwEAYDVQQDEwlsb2NhbGhvc3QwHhcNMjQwNjEyMTI1ODEyWhcNMjUwNjEyMTI1ODEyWjAUMRIwEAYDVQQDEwlsb2NhbGhvc3QwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAR3y7tOOo6VXuEL2A2/7Z9Nnb0BnERPx6Azo5DC3untp4BZZMrqHWfbZfEQxQDHocGC2cpHIbRhAdZBCu2QAxmzMAoGCCqGSM49BAMCA0gAMEUCIAEswEPrbKCn5MLV93XQTjuwGdg8zB34hQhI/0aFAs1HAiEA4RrTkqpNUIrbFrsaHNxxftdUunSHQ9OaU6hWo4o+LZk="],"x":"d8u7TjqOlV7hC9gNv-2fTZ29AZxET8egM6OQwt7p7ac","y":"gFlkyuodZ9tl8RDFAMehwYLZykchtGEB1kEK7ZADGbM"}}
```

Decoded attestation body:

```json
{"iss":"http://localhost:8080","sub":"http://localhost:8080","cnf":{"jwk":{"kty":"EC","use":"sig","crv":"P-256","kid":"2a1d9b08-14c7-4da0-bb89-4ad67a6ad04d","x":"bDC3c1BNHIXbL7JxftnDQ5X8MsK3G7StGfsBfcLYY9g","y":"5JQ5F3sJBwVrh3NJMT2FtjAc2D35viGoeebGn9Ep8bA","iat":1718197539},"key_type":"secure_element","user_authentication":"secure_element_pin"},"exp":1718197895,"iat":1718197595,"aal":"https://trust-list.eu/aal/high"}
```

`iss` corresponds to wallet provider backend, `sub` to wallet client id

## Corresponding attestation PoP example

```base64url
eyJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJleHAiOjE3MTgxOTc3NDIsImlhdCI6MTcxODE5NzY4Miwibm9uY2UiOiJub25jZSIsImp0aSI6ImE0YzYxMTFhLTk5ZTgtNDUxOS1hMjZlLWEzODk1NWMxMzY4NSJ9.FwmYhFl7zPXG1f2tbvzlAm2KEMQio2FI9zLotugDnC7Q4MXUWJ9QGg-v8R7zwgTQo5mtSieJdg1yS1GDbPgfqw
```

Decoded header:

```json
{"alg":"ES256"}
```

Decoded body:

```json
{"iss":"http://localhost:8080","aud":"http://localhost:8080","exp":1718197742,"iat":1718197682,"nonce":"nonce","jti":"a4c6111a-99e8-4519-a26e-a38955c13685"}
```

`aud` corresponds to authentication server, `iss` to wallet client id


## Request nonce for PoP

Issue a GET request at the PAR endpoint specified in the issuer OAuth authorization server metadata.
The information relevant for deciding upon attestation usage is the field `token_endpoint_auth_methods_supported` containing the value `attest_jwt_client_auth`:
```json
  "token_endpoint_auth_methods_supported":["attest_jwt_client_auth"]
```
If `attest_jwt_client_auth` is present, a wallet attestation and PoP needs to be sent with the pushed authorization request.

The response is the same as in the wallet backend.

## Usage of wallet attestation and PoP in pushed authorization request

The body of the pushed authorization request is form urlencoded and therefore two form parameters need to be added:

Parameter `client_assertion_type` with value 'urn:ietf:params:oauth:client-assertion-type:jwt-client-attestation'

Parameter `client_assertion` with value "\<wallet-attestation\>~\<wallet-attestation-pop>\". The placeholders need to be replaced with the corresponding values in compact serialization format.